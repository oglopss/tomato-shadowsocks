sudo: required
dist: trusty
language: bash
branches:
  only:
  - ss-only
cache:
  directories:
  - "$HOME/src"
  - "$HOME/x-tools"
addons:
  apt:
    packages:
    - bison
    - flex
    - gperf
    - libncurses5-dev
    - texinfo
    - help2man
    - asciidoc
    - xmlto
git:
  submodules: false
before_install:
- sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
- git submodule update --init --recursive
install:
- cd crosstool-ng
- git checkout tags/crosstool-ng-1.21.0
- cp $TRAVIS_BUILD_DIR/ctng.config ./.config -f
- "./bootstrap"
- "./configure --enable-local"
- make
- make install
env:
  matrix:
  - SS_VER=v3.1.3
  global:
  - secure: S79k11s3daFsF/b1dJRIRySC1bnsxgDhlgOu0ThKVhHoWtK6zrTAem6gCb2kHxoWzw73C9JBZKh3B5foldijG1vzTjU/7Emgm2Ip5+ZVuvpz3FDWmsyn4k+xvziqFC8cEeTF5QSDYnBV/dfaVbr7XvW9vyzFLKyGzUTROtobyKcdf6Tc7DZ7tdmvW/gFUlpcUkMkIN+G1pCbOPUzJqQWw9PsMLkDASuaOqSgg51BEawglhc/l3SrQrSVawsIyzIZ71fv1x54YtkItxkF/0ZXwerhVpE1hB4JnYvt0wkPeAxR8jE/L0w0x+Pw0diPJ5cjJNCuk7yIpF2H+WwpxhTGzCiHp5fv/UnG1uj6EUqp1YWHeaFUX1G3RV3AYiMjNx91TF2OoOY/fIE8zBVg2PkhDwOdwIAPEfphBtSC0v+lfiaVG3JdejMyw+VZ38CBVBVWOUQZdpVx0Wh76QHCqrP9W7AovbUqmPfTdRmQkhZLbpNUtQAP6e+Q4SUmtGkXTQbP9qbr033qFAvfWO9h7q3IJ0Bioshrkofr/aljAA5X1AyiR4pD95VrHuBykui5P7qCFF2VXxWfLOYFll9RYmy9vg1UrBXUw0LPK3jfMt884UxqUpgAMy7Oz2C6qxGQGhjx9OTXsxie4crbHWlkfax/g3Y0E6CCSZlFAxCVNspRr6I=
  - secure: Nihnui98r2hfkgfq7sPY/S8SYrwQ9v2BZEQps5PRxYuYDyb57uZzgHUCvpj8/t6F1/su4aJN2lSXYkpOrVk/QmCkj91TPIPXso4JZOKijUWboB2q81uwsawHmj9lKhYranrqhj2hr0YS04kLTzLfHjjwmtzKXbUucJq89qgkEvyUtj1Qwu8xIZpa8YgOHD/SpYlrNjS3StNDwsHpNiKjGiEJOAh4i2bWZQYJ0xJE5DJ8uAt+zEfvUvdUdSArIBklLW7ZmECqXft3ATulZNhWGJARid/wQeTxmwANAvIOv/UCBdCIQW8/fjerNqkkilyRzpbJXA2fsYAsINbt7xC7378IWmNE/f1fM4GaIsvx2k7i5e4p47Mbb9lv91lV9LWROjLr9RwKxlMhZvmL6pgALTj599LtyQ08xmKYClv4ZJ7gvoaRvfb6a8p07XSEuAdakxFtKkcvuCsYnYPmN1s4N2R2kSZBrBLlOOVK/F2Zk8h7x31kgSBQSrwZu6pjdYW4dW4uuyVdoCGONhgNsi7wUVk58DP66YFvQhkiHybGN++WCqG+KECMdGqUxwy9hpAnrtl9lGwrF3sOm2HIZ7ovgFQj9WccPdU4uM+YcVM5VzM27NCJQ24ShQ9RLpCtQtbm0TwJtq8ist471LlqbFfzkvGE7/Xl72hogpwjKSnOLqk=
  
script:
- ". $TRAVIS_BUILD_DIR/.travis.sh"
- upload_test
- ss_build
after_failure:
- tail -n 1000 $TRAVIS_BUILD_DIR/config/build.log
after_success: ". $TRAVIS_BUILD_DIR/update-gh-pages.sh"

sudo: required
dist: trusty
language: bash
branches:
  only:
  - ss-only
cache:
  directories:
  - "$HOME/src"
  - "$HOME/x-tools"
addons:
  apt:
    packages:
    - bison
    - flex
    - gperf
    - libncurses5-dev
    - texinfo
    - help2man
    - asciidoc
    - xmlto
git:
  submodules: false
before_install:
- sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
- git submodule update --init --recursive
install:
- cd crosstool-ng
- git checkout tags/crosstool-ng-1.21.0
- cp $TRAVIS_BUILD_DIR/ctng.config ./.config -f
- "./bootstrap"
- "./configure --enable-local"
- make
- make install
env:
  matrix:
  - SS_VER=v3.1.3
  global:
  - secure: S79k11s3daFsF/b1dJRIRySC1bnsxgDhlgOu0ThKVhHoWtK6zrTAem6gCb2kHxoWzw73C9JBZKh3B5foldijG1vzTjU/7Emgm2Ip5+ZVuvpz3FDWmsyn4k+xvziqFC8cEeTF5QSDYnBV/dfaVbr7XvW9vyzFLKyGzUTROtobyKcdf6Tc7DZ7tdmvW/gFUlpcUkMkIN+G1pCbOPUzJqQWw9PsMLkDASuaOqSgg51BEawglhc/l3SrQrSVawsIyzIZ71fv1x54YtkItxkF/0ZXwerhVpE1hB4JnYvt0wkPeAxR8jE/L0w0x+Pw0diPJ5cjJNCuk7yIpF2H+WwpxhTGzCiHp5fv/UnG1uj6EUqp1YWHeaFUX1G3RV3AYiMjNx91TF2OoOY/fIE8zBVg2PkhDwOdwIAPEfphBtSC0v+lfiaVG3JdejMyw+VZ38CBVBVWOUQZdpVx0Wh76QHCqrP9W7AovbUqmPfTdRmQkhZLbpNUtQAP6e+Q4SUmtGkXTQbP9qbr033qFAvfWO9h7q3IJ0Bioshrkofr/aljAA5X1AyiR4pD95VrHuBykui5P7qCFF2VXxWfLOYFll9RYmy9vg1UrBXUw0LPK3jfMt884UxqUpgAMy7Oz2C6qxGQGhjx9OTXsxie4crbHWlkfax/g3Y0E6CCSZlFAxCVNspRr6I=
  - secure: K32opb089kna8bEQPcEWlnqMaNJM2pnySn0IC3logGIBlNGSZaS9GLeP+Y7CwwyxrJ6qFNKxOhslApMO/8ENEXJHeUPAJy8JBSOQAsc6ylG9ihRYuqKYiBmGA/HCK2Z9OJSvEbWtvknqDqTIR0L8p2mNKU4degqaI5G5zvUkAgAWvquKzR4o2p1orAHN4VW0FR8/iwwJSEnFLPnv+KrIEoapwOn6BvY927EkGmm+TX4JnuHeccJvIXbEvb4APlVuuqexp4VJGSyTc9AbLfmJrXZqwX/kZuh752GzzQI2Wc7egWgr5BPxUd+rimiI8oGZ5uMSJB/0pSNjirnlSTCBRd10KmRIM47W1i+mOolndzZ81ZY20zw5kiCT+/XWduy5luhsbniSrwC0MRolNL34gG1r8+c48tCqsre9+cQNFgI8FsLrDTjvkg6RFAZ7LauXOKFDZO96XZp2oq9qPrvb54RhU+N2E981pAL9wlWmWjzD0xblGbT17i6JcMRhanxvf7plw39j6YmFFxqS+NbySKUoyylaliY4Bepmd2wPThxJpRjCaiLPlYwpFZoNFtYQZRG5q2PiLwF0kXkJRv2VItKyzWpiapVhdRWPqYwtdto6o2Lpa1eExXhhXsWZFTnor6jYmZTi0jZCGC5cMG19tZ76kq9jsrq3WbviDuAAbZQ=
  
script:
- ". $TRAVIS_BUILD_DIR/.travis.sh"
- upload_test
- ss_build
after_failure:
- tail -n 1000 $TRAVIS_BUILD_DIR/config/build.log
after_success: ". $TRAVIS_BUILD_DIR/update-gh-pages.sh"
